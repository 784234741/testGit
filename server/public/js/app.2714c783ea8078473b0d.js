webpackJsonp([1],{"+6Xh":function(t,e){},"+ol3":function(t,e){},"387X":function(t,e,n){"use strict";var s=n("d8IM"),i=n.n(s),a=n("SQw1");var r=function(t){n("dgzr")},o=n("VU/8")(i.a,a.a,!1,r,null,null);e.default=o.exports},"6JOt":function(t,e,n){"use strict";var s={render:function(){var t=this.$createElement;return(this._self._c||t)("h1",[this._v("我的")])},staticRenderFns:[]};e.a=s},"91R0":function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("7+uW"),i=n("x6bz"),a=n.n(i),r={name:"App",data:function(){return{socket:null}},methods:{createSocket:function(){var t=a()("http://localhost:3000");t.emit("online",sessionStorage.getItem("id")),t.on("receivemsg",function(t){console.log(t)}),this.socket=t,this.$root.$socket=this.socket}}},o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view",{on:{createsocket:this.createSocket}})],1)},staticRenderFns:[]};var l=n("VU/8")(r,o,!1,function(t){n("r7L+")},null,null).exports,c=n("/ocq"),u={name:"Login",data:function(){return{uname:"",pwd:"",tips:!1}},methods:{submit:function(){var t=this;this.$http.post("api/users/login",{uname:this.uname,pwd:this.pwd}).then(function(e){0==e.data.errCode?(sessionStorage.setItem("id",e.data.userInfo.id),t.$store.commit("updateUser",e.data.userInfo),t.$store.commit("createSocket"),t.$router.push("index/")):t.tips=!0})}},computed:{disabled:function(){return""==this.uname||""==this.pwd}}},d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",[n("el-main",[n("el-form",[n("el-form-item",{attrs:{label:"用户名"}},[n("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:t.uname,callback:function(e){t.uname=e},expression:"uname"}})],1),t._v(" "),n("el-form-item",[n("label",{attrs:{slot:"label"},slot:"label"},[t._v("密   码")]),t._v(" "),n("el-input",{attrs:{"show-password":"",placeholder:"请输入密码"},model:{value:t.pwd,callback:function(e){t.pwd=e},expression:"pwd"}})],1),t._v(" "),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.tips,expression:"tips"}],staticClass:"tips"},[n("el-alert",{attrs:{title:"登录失败:用户名或密码错误",type:"error","show-icon":""}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"success",disabled:t.disabled},on:{click:t.submit}},[t._v("登 录")])],1)],1)],1),t._v(" "),n("el-footer",[n("router-link",{staticClass:"el-link el-link--primary",attrs:{to:"register"}},[t._v("注册")]),t._v(" "),n("router-link",{staticClass:"el-link el-link--primary",attrs:{to:"found"}},[t._v("找回密码")])],1)],1)},staticRenderFns:[]};var p=n("VU/8")(u,d,!1,function(t){n("puM+")},"data-v-6a782043",null).exports,f={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",[n("el-main",[n("el-form",[n("el-form-item",{attrs:{label:"用户名"}},[n("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:t.uname,callback:function(e){t.uname=e},expression:"uname"}})],1),t._v(" "),n("el-form-item",[n("label",{attrs:{slot:"label"},slot:"label"},[t._v("密   码")]),t._v(" "),n("el-input",{attrs:{"show-password":"",placeholder:"请输入密码"},model:{value:t.pwd,callback:function(e){t.pwd=e},expression:"pwd"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"success"},on:{click:t.register}},[t._v("注 册")])],1)],1)],1),t._v(" "),n("el-footer",[n("router-link",{staticClass:"el-link el-link--primary",attrs:{to:"login"}},[t._v("登录")]),t._v(" "),n("router-link",{staticClass:"el-link el-link--primary",attrs:{to:"found"}},[t._v("找回密码")])],1)],1)},staticRenderFns:[]};var v=n("VU/8")({name:"Register",data:function(){return{uname:"",pwd:""}},methods:{register:function(){var t=this;this.$http.post("api/users/register",{uname:this.uname,pwd:this.pwd},{}).then(function(e){0==e.data.errCode&&t.$router.push("login")})}}},f,!1,function(t){n("91R0")},"data-v-5564fc72",null).exports,h=n("UmRV"),m={data:function(){return{applys:[]}},methods:{addFriend:function(){this.$router.push("/addFriend")},changeIt:function(t){this.applys=this.applys.filter(function(e){return e.id!=t})}},beforeCreate:function(){var t=this;this.$isLogin(),this.$http.get("api/users/get?id="+sessionStorage.getItem("id")).then(function(e){t.applys=e.data.friends})}},_={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",[n("el-header",[n("div",[t._v("微信")]),t._v(" "),n("div",[n("i",{staticClass:"el-icon-search"}),t._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Bottom Right 提示文字",placement:"bottom-end"}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("div",{on:{click:t.addFriend}},[n("i",{staticClass:"el-icon-s-custom"}),t._v(" "),n("span",[t._v("添加朋友")])]),t._v(" "),n("div",[n("i",{staticClass:"el-icon-s-comment"}),t._v(" "),n("span",[t._v("发起群聊")])]),t._v(" "),n("div",[n("i",{staticClass:"el-icon-s-cooperation\n"}),t._v(" "),n("span",[t._v("扫一扫")])]),t._v(" "),n("div",[n("i",{staticClass:"el-icon-s-finance"}),t._v(" "),n("span",[t._v("收付款")])]),t._v(" "),n("div",[n("i",{staticClass:"el-icon-s-promotion"}),t._v(" "),n("span",[t._v("帮助与反馈")])])]),t._v(" "),n("i",{staticClass:"el-icon-circle-plus-outline"})])],1)]),t._v(" "),n("el-main",[n("keep-alive",[n("router-view",{attrs:{applys:t.applys},on:{change:t.changeIt}})],1)],1),t._v(" "),n("el-footer",[n("el-row",[n("el-col",{attrs:{span:6}},[n("router-link",{attrs:{to:"list"}},[n("i",{staticClass:"el-icon-chat-round"}),t._v(" "),n("span",[t._v("微信")])])],1),t._v(" "),n("el-col",{attrs:{span:6}},[n("router-link",{staticClass:"friends",attrs:{to:"friends"}},[t.applys.length>0?n("el-badge",{staticClass:"item",attrs:{value:t.applys.length}}):t._e(),t._v(" "),n("i",{staticClass:"el-icon-notebook-1"}),t._v(" "),n("span",[t._v("通讯录")])],1)],1),t._v(" "),n("el-col",{attrs:{span:6}},[n("router-link",{attrs:{to:"discovery"}},[n("i",{staticClass:"el-icon-discover"}),t._v(" "),n("span",[t._v("发现")])])],1),t._v(" "),n("el-col",{attrs:{span:6}},[n("router-link",{attrs:{to:"me"}},[n("i",{staticClass:"el-icon-user"}),t._v(" "),n("span",[t._v("我")])])],1)],1)],1)],1)},staticRenderFns:[]};var g=n("VU/8")(m,_,!1,function(t){n("fKMq")},"data-v-693568a8",null).exports,k=n("woOf"),b=n.n(k),$={props:["applys","test"],data:function(){return{list:this.deepCopy(this.applys),friends:[]}},watch:{applys:function(t,e){console.log("watch监听值发生变化"),this.list=this.deepCopy(t)}},methods:{agree:function(t){var e=this;this.$http.get("api/users/agree?id="+t.id+"&fa="+t.fa+"&fb="+t.fb).then(function(n){0==n.data.errCode&&(e.$emit("change",t.id),e.getFriends())})},refuse:function(t){var e=this;this.$http.get("api/users/refuse?id="+t.id).then(function(n){0==n.data.errCode&&e.$emit("change",t.id)})},deepCopy:function(t){return t.map(function(t){return b()(t)})},getFriends:function(){var t=this;this.$http.get("api/users/getFriends?id="+sessionStorage.getItem("id")).then(function(e){t.friends=e.data.friends})},chat:function(t){this.$router.push("/chat/"+t.fb+"/"+t.uname+"/"+t.profile)}},created:function(){console.log("create被调用"),this.getFriends()}},w={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.list.length?n("ul",[n("li",[t._v("好友申请")]),t._v(" "),t._l(t.list,function(e){return n("li",[n("div",{staticClass:"block"},[n("el-avatar",{attrs:{shape:"square",size:50,src:t.$baseURL+e.profile}})],1),t._v(" "),n("div",[t._v(t._s(e.uname))]),t._v(" "),n("div",[n("el-button",{attrs:{type:"primary"},on:{click:function(n){return t.agree(e)}}},[t._v("同意")]),t._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:function(n){return t.refuse(e)}}},[t._v("拒绝")])],1)])})],2):t._e(),t._v(" "),n("ul",[n("li",[t._v("好友列表")]),t._v(" "),t._l(t.friends,function(e){return n("li",{on:{click:function(n){return t.chat(e)}}},[n("div",{staticClass:"block"},[n("el-avatar",{attrs:{shape:"square",size:50,src:t.$baseURL+e.profile}})],1),t._v(" "),n("div",[t._v(t._s(e.uname))])])})],2)])},staticRenderFns:[]};var C=n("VU/8")($,w,!1,function(t){n("tlNq")},"data-v-34368926",null).exports,y={data:function(){return{msg:[]}},methods:{chat:function(t){this.$router.push("/chat/"+t.toB+"/"+t.uname+"/"+t.profile)}},beforeCreate:function(){var t=this;this.$http.get("api/chat?id="+sessionStorage.getItem("id")).then(function(e){t.msg=e.data.msg})}},x={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",t._l(t.msg,function(e){return n("li",{on:{click:function(n){return t.chat(e)}}},[n("div",{staticClass:"block"},[n("el-avatar",{attrs:{shape:"square",size:50,src:t.$baseURL+e.profile}})],1),t._v(" "),n("div",[n("div",[t._v(t._s(e.uname))]),t._v(" "),n("div",[t._v(t._s(e.msg))])]),t._v(" "),n("div",[t._v(t._s(e.systime))])])}),0)},staticRenderFns:[]};var F=n("VU/8")(y,x,!1,function(t){n("+6Xh")},"data-v-7a833e6f",null).exports,I=n("387X"),R=n("ee5f"),S={data:function(){return{uname:"",warn:!1,profile:"",detail:!1,uid:0,is_friend:0}},methods:{goback:function(){this.$router.go(-1)},search:function(){var t=this;this.$http.get("api/users/search?uname="+this.uname).then(function(e){0==e.data.errCode?(t.warn=!1,t.profile=t.$baseURL+e.data.userInfo.profile,t.uid=e.data.userInfo.id,t.$http.get("api/users/getFriends?id="+sessionStorage.getItem("id")).then(function(e){e.data.friends.findIndex(function(e){return e.fb==t.uid})>=0&&(t.is_friend=1)}),t.uid==sessionStorage.getItem("id")&&(t.is_friend=2),t.detail=!0):t.warn=!0})},addFriend:function(){var t=this;this.$http.post("api/users/add",{fa:sessionStorage.getItem("id"),fb:this.uid}).then(function(e){console.log(e),0==e.data.errCode?t.$message({message:"好友申请发送成功~",type:"success"}):2==e.data.errCode?t.$message({message:"已发送过好友申请~",type:"warning"}):t.$message.error("好友申请发送失败~")})}},beforeCreate:function(){this.$isLogin()}},U={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",[n("el-header",[n("i",{staticClass:"el-icon-arrow-left",on:{click:t.goback}}),t._v(" "),n("span",[t._v("添加朋友")])]),t._v(" "),n("el-main",[n("div",{staticClass:"search"},[n("el-input",{attrs:{placeholder:"用户名","prefix-icon":"el-icon-search"},on:{focus:function(e){t.detail=!1,t.is_friend=0}},model:{value:t.uname,callback:function(e){t.uname=e},expression:"uname"}}),t._v(" "),n("el-button",{attrs:{type:"success"},on:{click:t.search}},[t._v("搜索")])],1),t._v(" "),n("el-alert",{directives:[{name:"show",rawName:"v-show",value:t.warn,expression:"warn"}],ref:"warning",attrs:{title:"用户不存在",type:"warning","show-icon":""}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.detail,expression:"detail"}],staticClass:"detail"},[n("div",{staticClass:"block"},[n("el-avatar",{attrs:{shape:"square",size:50,src:t.profile}})],1),t._v(" "),n("div",[t._v(t._s(t.uname))]),t._v(" "),n("div",[0==t.is_friend?n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.addFriend}},[t._v("好友")]):1==t.is_friend?n("span",[t._v("已是朋友")]):2==t.is_friend?n("span",[t._v("当前用户")]):t._e()],1)])],1)],1)},staticRenderFns:[]};var V=n("VU/8")(S,U,!1,function(t){n("wX7u")},"data-v-2a31a940",null).exports,L={props:["uid","uname","profile"],data:function(){return{msg:"",list:[]}},methods:{goback:function(){this.$router.go(-1)},sendMsg:function(){this.$store.state.socket.emit("sendmsg",{msg:this.msg,fromA:sessionStorage.getItem("id"),toB:this.uid}),this.msg=""},getChat:function(){var t=this;this.$http.get("api/chat/getChat?uid1="+sessionStorage.getItem("id")+"&uid2="+this.uid).then(function(e){t.list=e.data.msg,console.log(t.list)})}},beforeCreate:function(){this.$isLogin()},created:function(){this.getChat()},computed:{updateMsg:function(){return this.$store.state.msg}},watch:{updateMsg:function(t){(t.fromA==sessionStorage.getItem("id")&&t.toB==this.uid||t.toB==sessionStorage.getItem("id")&&t.fromA==this.uid)&&this.list.push(t)}}},A={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",[n("el-header",[n("i",{staticClass:"el-icon-arrow-left",on:{click:t.goback}}),t._v(" "),n("span",[t._v(t._s(t.uname))])]),t._v(" "),n("el-main",[n("ul",t._l(t.list,function(e){return n("li",{class:[e.fromA==t.uid?"left":"right"]},[n("div",{staticClass:"block"},[n("el-avatar",{attrs:{shape:"square",size:50,src:t.$baseURL+(e.fromA==t.uid?t.profile:t.$store.state.userInfo.profile)}})],1),t._v(" "),n("div",{staticClass:"msg"},[t._v(t._s(e.msg))])])}),0)]),t._v(" "),n("el-footer",[n("el-input",{attrs:{placeholder:"你想说点什么"},model:{value:t.msg,callback:function(e){t.msg=e},expression:"msg"}}),t._v(" "),n("el-button",{attrs:{type:"success",size:"medium"},on:{click:t.sendMsg}},[t._v("发送")])],1)],1)},staticRenderFns:[]};var E=n("VU/8")(L,A,!1,function(t){n("+ol3")},"data-v-057bd01c",null).exports,M=n("kd5l");s.default.use(c.a);var q=new c.a({routes:[{path:"/",component:p},{path:"/login",name:"Login",component:p},{path:"/register",name:"Register",component:v},{path:"/found",name:"Found",component:h.default},{path:"/index",component:g,children:[{path:"list",component:F},{path:"friends",component:C},{path:"discovery",component:I.default},{path:"me",component:R.default},{path:"",redirect:"list"}]},{path:"/addfriend",component:V},{path:"/chat/:uid/:uname/:profile",component:E,props:!0},{path:"*",component:M.default}]}),z=n("zL8q"),N=n.n(z),X=(n("tvR6"),n("mtWM")),B=n.n(X),J=n("NYxO");s.default.use(J.a);var O=new J.a.Store({state:{userInfo:{},socket:null,msg:{}},mutations:{updateUser:function(t,e){t.userInfo=e},createSocket:function(t){var e=a()("http://localhost:3000");e.emit("online",sessionStorage.getItem("id")),e.on("receivemsg",function(e){console.log(e),t.msg=e}),t.socket=e},closeSocket:function(t){t.socket.emit("offline",sessionStorage.getItem("id")),t.socket.close()}}});s.default.config.productionTip=!1,s.default.use(N.a),s.default.prototype.$http=B.a,s.default.prototype.$isLogin=function(){sessionStorage.getItem("id")||(console.log("用户未登录！"),this.$router.push("/login"))},s.default.prototype.$baseURL="http://localhost:3000/",new s.default({el:"#app",router:q,components:{App:l},template:"<App/>",store:O})},PNhl:function(t,e){},SQw1:function(t,e,n){"use strict";var s={render:function(){var t=this.$createElement;return(this._self._c||t)("h1",[this._v("朋友圈")])},staticRenderFns:[]};e.a=s},UmRV:function(t,e,n){"use strict";var s=n("vPFm"),i=n.n(s),a=n("f4pJ");var r=function(t){n("Vngu")},o=n("VU/8")(i.a,a.a,!1,r,null,null);e.default=o.exports},Vngu:function(t,e){},Vp3r:function(t,e){},XvAk:function(t,e){},d8IM:function(t,e){},dgzr:function(t,e){},eFAi:function(t,e,n){"use strict";var s={render:function(){var t=this.$createElement;return(this._self._c||t)("el-empty",{attrs:{description:"服务器走失了"}})},staticRenderFns:[]};e.a=s},ee5f:function(t,e,n){"use strict";var s=n("kTiL"),i=n.n(s),a=n("6JOt");var r=function(t){n("Vp3r")},o=n("VU/8")(i.a,a.a,!1,r,null,null);e.default=o.exports},f4pJ:function(t,e,n){"use strict";var s={render:function(){var t=this.$createElement;return(this._self._c||t)("div",[this._v("找回密码")])},staticRenderFns:[]};e.a=s},fKMq:function(t,e){},kTiL:function(t,e){},kd5l:function(t,e,n){"use strict";var s=n("PNhl"),i=n.n(s),a=n("eFAi");var r=function(t){n("XvAk")},o=n("VU/8")(i.a,a.a,!1,r,null,null);e.default=o.exports},"puM+":function(t,e){},"r7L+":function(t,e){},tlNq:function(t,e){},tvR6:function(t,e){},vPFm:function(t,e){},wX7u:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.2714c783ea8078473b0d.js.map